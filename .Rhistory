# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat=identity)
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity")
# + xlab("Year") + ylab("Defense Budget")
# + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity")+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget), fill='green') + geom_bar(stat="identity")+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='green')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='greenyellow')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='green4')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# attacks by year
attacks_hist <- ggplot(data=terror_war)+ geom_histogram(aes(x=iyear), fill='orchid') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_hist
# attacks by year
attacks_hist <- ggplot(data=terror_war)+ geom_histogram(aes(x=iyear), fill='orchid4') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_hist
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='green4')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
war_cor <- cbind(attack_yr, spending)
war_cor
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=color))
scatter1
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=year))
scatter1
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=Year))
scatter1
# create a table
cor.test(war_cor, method="spearman")
# create a table
cor(war_cor)
scatter1
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=Year)) + xlab("Defense Budget") + ylab(Terrorist Attacks Per Year) +
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=Year)) + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks")
scatter1
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
?function
sdf
?function()
```{r, echo=FALSE}
r_squared <- function(coef){
return coef ** 2
return (coef ** 2)
cor(war_cor, method="spearman")
cor_table
cor_table <- cor(war_cor, method="spearman")
cor_table
class(cor_table)
colnames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
rownames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
cor_table
# import data
terrorism_db <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/globalterrorismdb.csv")
military_spending <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/MilitarySpending.csv")
troop_deployment <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/troopdataEU.csv")
library(dplyr)
# import data
terrorism_db <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/globalterrorismdb.csv")
military_spending <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/MilitarySpending.csv")
troop_deployment <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/troopdataEU.csv")
library(dplyr)
# import data
terrorism_db <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/globalterrorismdb.csv")
military_spending <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/MilitarySpending.csv")
troop_deployment <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/troopdataEU.csv")
# terrorism look
head(terrrorism_db)
# troop deployment look
head(troop_deployment)
tail(troop_deployment)
names(troop_deployment)
tail(terrorism_db)
names(terrorsim_db)
names(terrorism_db)
tail(terrorism_db)
names(terrorism_db)
# terrorism look
head(terrorism_db)
# terrorism look
head(terrorism_db)
tail(terrorism_db)
names(terrorism_db)
# select pertinent columns
terrorism2 <- terrorism_db %>% select(iyear, imonth, country_txt, region, success, nkill)
# troop deployment look
head(troop_deployment)
tail(troop_deployment)
names(troop_deployment)
head(military_spending)
tail(military_spending)
names(military_spending)
terror_war <- terrorism2 %>% full_join(military_spending, by=c('iyear'='Year'))
terror_war <- terror_war %>% rename_with(tolower)
terror_war <- terror_war %>% filter(iyear>=1970)
terror_war %>%
arrange(iyear) %>%
slice(c(1:5),(50000:50005),(175000:175005))
library(pastecs)
# split into before and after
before <- terror_war %>% filter(iyear <= 2001)
after <- terror_war %>% filter(iyear > 2001)
# num attacks before and after 9/11
nrow(before)
nrow(after)
before_attacks <- before %>% group_by(iyear) %>% summarize(nrow(iyear))
# summary stats
stat.desc(before)
stat.desc(after)
# those stats aren't very helpful since defense budget is listed multiple times so we should go back to the original dataset
# Let's look at the defense budget!
before %>% arrange(desc(nkill))
spending_before <- military_spending %>% filter(Year <=2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_after <- military_spending %>% filter(Year > 2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_before
spending_after
# us terror attacks
us_terrorism <- terror_war %>% filter(country_txt=="United States")
us_terrorismb <- us_terrorism %>% filter(iyear <= 2001)
us_terrorisma <- us_terrorism %>% filter(iyear>2001)
nrow(us_terrorismb)
nrow(us_terrorisma)
# correlation tests!!
attack_yr <- count(terror_war$iyear)
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
cor1 <- cor.test(attack_yr$freq, spending$DefenseBudget, method="spearman", conf.level = .99, exact = FALSE)
cor2 <- cor(attack_yr$freq, spending$DefenseBudget, method="spearman")
r_sq <- cor2 ** 2
r_sq
library(ggplot2)
# attacks by year
attacks_hist <- ggplot(data=terror_war)+ geom_histogram(aes(x=iyear), fill='orchid4') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_hist
# us attacks by year
attacks_us <- ggplot(data=us_terrorism) + geom_histogram(aes(x=iyear), fill='blue') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("US Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_us
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='green4')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=Year)) + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks")
scatter1
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=freq)) + geom_point(aes(color=x)) + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks")
scatter1
cor_table <- cor(war_cor, method="spearman")
colnames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
rownames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
cor_table
# correlation tests!!
attack_yr <- count(terror_war$iyear)
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
library(pastecs)
# split into before and after
before <- terror_war %>% filter(iyear <= 2001)
after <- terror_war %>% filter(iyear > 2001)
# num attacks before and after 9/11
nrow(before)
nrow(after)
before_attacks <- before %>% group_by(iyear) %>% summarize(nrow(iyear))
# summary stats
stat.desc(before)
# those stats aren't very helpful since defense budget is listed multiple times so we should go back to the original dataset
# Let's look at the defense budget!
before %>% arrange(desc(nkill))
spending_before <- military_spending %>% filter(Year <=2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_after <- military_spending %>% filter(Year > 2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_before
spending_after
library(pastecs)
# split into before and after
before <- terror_war %>% filter(iyear <= 2001)
after <- terror_war %>% filter(iyear > 2001)
# num attacks before and after 9/11
nrow(before)
nrow(after)
before_attacks <- before %>% group_by(iyear) %>% summarize(nrow(iyear))
# summary stats
stat.desc(before)
stat.desc(after)
# those stats aren't very helpful since defense budget is listed multiple times so we should go back to the original dataset
# Let's look at the defense budget!
before %>% arrange(desc(nkill))
spending_before <- military_spending %>% filter(Year <=2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_after <- military_spending %>% filter(Year > 2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_before
spending_after
# us terror attacks
us_terrorism <- terror_war %>% filter(country_txt=="United States")
us_terrorismb <- us_terrorism %>% filter(iyear <= 2001)
us_terrorisma <- us_terrorism %>% filter(iyear>2001)
nrow(us_terrorismb)
nrow(us_terrorisma)
# correlation tests!!
attack_yr <- count(terror_war$iyear)
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
cor1 <- cor.test(attack_yr$freq, spending$DefenseBudget, method="spearman", conf.level = .99, exact = FALSE)
cor2 <- cor(attack_yr$freq, spending$DefenseBudget, method="spearman")
r_sq <- cor2 ** 2
r_sq
class(iyear)
class(terror_war$iyear)
?count
# correlation tests!!
attack_yr <- dplyer::count(terror_war$iyear)
# correlation tests!!
attack_yr <- dplyr::count(terror_war$iyear)
# correlation tests!!
attack_yr <- terror_war %>% dplyr::count(iyear)
class(terror_war$iyear)
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
war_cor
war_cor <- full_join(attack_yr, spending, by=c("x"="Year"))
spending
attack_yr
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("iyear"="Year"))
war_cor
cor1 <- cor.test(attack_yr$freq, spending$DefenseBudget, method="spearman", conf.level = .99, exact = FALSE)
class(attack_yr$freq)
war_cor
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks")
scatter1
# terrorism look
head(terrorism_db)
tail(terrorism_db)
names(terrorism_db)
knitr::kable(cor_table)
library(ggplot2)
library(caTools)
library(class)
library(caret)
install.packages("caret")
for(i in kmatrix){
index = i + 1
kModBin <- knn(train=training_binary, test=test_binary, cl=training_binary$label, k=i)
accBin[index] <- 100*sum(test_binary$label == kModBin)/NROW(test_binary$label)
}
library(caret)
binary <- read.csv("C:/Users/stewa/Documents/GitHub/dsc520/data/binary-classifier-data.csv")
binary <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/data/binary-classifier-data.csv")
trinary <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/data/trinary-classifier-data.csv")
binary_plot <- ggplot(binary, aes(x=x, y=y, colour=label)) + geom_point()
trinary_plot <- ggplot(trinary, aes(x=x, y=y, colour=label)) + geom_point()
binary_plot
trinary_plot
# split binary into test and training set
train_index <- createDataPartition(binary$label, p=.6)$Resample1
training_binary <- binary[train_index, ]
test_binary <- binary[-train_index, ]
# matrix for num of clusters
kmatrix <- c(3, 5, 10, 15, 20, 25)
# will collect accuracy count for clusters
accBin <- c()
# runs nearest neighbor for every given k in kmatrix
# calculates accuracy for each loops
index <- 0
for(i in kmatrix){
index = i + 1
kModBin <- knn(train=training_binary, test=test_binary, cl=training_binary$label, k=i)
accBin[index] <- 100*sum(test_binary$label == kModBin)/NROW(test_binary$label)
}
library(class)
for(i in kmatrix){
index = i + 1
kModBin <- knn(train=training_binary, test=test_binary, cl=training_binary$label, k=i)
accBin[index] <- 100*sum(test_binary$label == kModBin)/NROW(test_binary$label)
}
# plotting accuracy vs k
accBin
accBin
class(accBin)
class(accBin[3])
row.names(accBin)
nrow(accBin)
accBin[4]
# plotting accuracy vs k
accuracy_plot <- ggplot(data = accBin, aes(x = kmatrix, y = accBin)) + geom_point()
accuracy_plot
# plotting accuracy vs k
accuracy_plot <- ggplot(data = accBin, aes(x = kmatrix, y = accBin)) + geom_point()
# plotting accuracy vs k
accuracy_df <- data.frame(accBin)
accuracy_df
accBin[4]
accuracy_df$ID <- seq.int(nrow(accuracy_df))
accuracy_df$ID
accuracy_plot <- ggplot(data = accuracy_df, aes(x = ID, y = accBin)) + geom_point()
accuracy_plot
# split binary into test and training set
train_index <- createDataPartition(trinary$label, p=.6)$Resample1
training_trinary <- trinary[train_index, ]
test_trinary <- trinary[-train_index, ]
# matrix for num of clusters
kmatrix <- c(3, 5, 10, 15, 20, 25)
# will collect accuracy count for clusters
acc_Trin <- c()
# runs nearest neighbor for every given k in kmatrix
# calculates accuracy for each loops
index <- 0
for(i in kmatrix){
index = i + 1
kModBin <- knn(train=training_trinary, test=test_trinary, cl=training_trinary$label, k=i)
acc_Trin[index] <- 100*sum(test_trinary$label == kModBin)/NROW(test_trinary$label)
}
# plotting accuracy vs k
accuracy_df2 <- data.frame(acc_Trin)
accuracy_df2$ID <- seq.int(nrow(accuracy_df2))
accuracy_plot2 <- ggplot(data = accuracy_df2, aes(x = ID, y = acc_Trin)) + geom_point()
accuracy_plot2
library(dplyr)
# import data
terrorism_db <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/globalterrorismdb.csv")
military_spending <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/MilitarySpending.csv")
terrorism2 <- terrorism_db %>% select(iyear, imonth, country_txt, region, success, nkill)
terror_war <- terrorism2 %>% full_join(military_spending, by=c('iyear'='Year'))
terror_war <- terror_war %>% rename_with(tolower)
terror_war <- terror_war %>% filter(iyear>=1970)
terror_war %>%
arrange(iyear) %>%
slice(c(1:5),(50000:50005),(175000:175005))
library(dplyr)
# import data
terrorism_db <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/globalterrorismdb.csv")
military_spending <- read.csv("C:/Users/Stewart/Documents/GitHub/dsc520/final_project/data/MilitarySpending.csv")
terrorism2 <- terrorism_db %>% select(iyear, imonth, country_txt, region, success, nkill)
terror_war <- terrorism2 %>% full_join(military_spending, by=c('iyear'='Year'))
terror_war <- terror_war %>% rename_with(tolower)
terror_war <- terror_war %>% filter(iyear>=1970)
terror_war %>%
arrange(iyear) %>%
slice(c(1:5),(50000:50005),(175000:175005))
library(pastecs)
# split into before and after
before <- terror_war %>% filter(iyear <= 2001)
after <- terror_war %>% filter(iyear > 2001)
# num attacks before and after 9/11
before_attacks <- before %>% group_by(iyear) %>% summarize(nrow(iyear))
# Let's look at the defense budget!
before %>% arrange(desc(nkill))
spending_before <- military_spending %>% filter(Year <=2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_after <- military_spending %>% filter(Year > 2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
# us terror attacks
us_terrorism <- terror_war %>% filter(country_txt=="United States")
us_terrorismb <- us_terrorism %>% filter(iyear <= 2001)
us_terrorisma <- us_terrorism %>% filter(iyear>2001)
# correlation tests!!
attack_yr <- terror_war %>% dplyr::count(iyear)
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("iyear"="Year"))
cor1 <- cor.test(attack_yr$n, spending$DefenseBudget, method="spearman", conf.level = .99, exact = FALSE)
cor2 <- cor(attack_yr$n, spending$DefenseBudget, method="spearman")
r_sq <- cor2 ** 2
# find p-values
# p-value < .005 so not likely due to chance
# attacks by year
attacks_hist <- ggplot(data=terror_war)+ geom_histogram(aes(x=iyear), binwidth = 1, fill='orchid4') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
# attacks by year
library(ggplot2)
attacks_hist <- ggplot(data=terror_war)+ geom_histogram(aes(x=iyear), binwidth = 1, fill='orchid4') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_hist
# us attacks by year
attacks_us <- ggplot(data=us_terrorism) + geom_histogram(aes(x=iyear), binwidth=1, fill='blue') + xlab("Year") + ylab("Terrorist Attacks") + ggtitle("US Terrorist Attacks by Year (1970-2019)") + geom_vline(xintercept = 2001, colour='red')
attacks_us
# military expenditure bar
expenses <- ggplot(data = military_spending, aes(x=Year, y=DefenseBudget)) + geom_bar(stat="identity", fill='green4')+ xlab("Year") + ylab("Defense Budget") + ggtitle("US Military Expenditure by Year (1960-2020)") + geom_vline(xintercept=2001, colour='red')
expenses
# plotting military expenditure against terrorist attacks
scatter1 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks")
scatter1
cor_table <- cor(war_cor, method="spearman")
colnames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
rownames(cor_table) <- c("Year", "Attacks", "DefenseBudget", "GDP", "Population")
knitr::kable(cor_table)
# simple regression outcome: Attacks per year, predictor: defense budget
terror_lm <-  lm(n ~ DefenseBudget, data=war_cor)
summary(terror_lm)
scatter2 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) +  geom_smooth(method="lm") + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") +
ggtitle("Relationship Between Defense Budget and Terrorist Attacks with Regression Line")
scatter2
# simple regression outcome: Attacks per year, predictor: defense budget
terror_lm <-  lm(n ~ DefenseBudget, data=war_cor)
summary(terror_lm)
scatter2 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) +  geom_smooth(method="lm") + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") + ggtitle("Relationship Between Defense Budget and Terrorist Attacks with Regression Line")
scatter2
# simple regression outcome: Attacks per year, predictor: defense budget
terror_lm <-  lm(n ~ DefenseBudget, data=war_cor)
summary(terror_lm)
scatter2 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) +  geom_smooth(method="lm") + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") + ggtitle("Relationship Between Defense Budget and Terrorist Attacks with Regression Line")
scatter1
# simple regression outcome: Attacks per year, predictor: defense budget
terror_lm <-  lm(n ~ DefenseBudget, data=war_cor)
summary(terror_lm)
scatter2 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) +  geom_smooth(method="lm") + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") + ggtitle("Relationship Between Defense Budget and Terrorist Attacks with Regression Line")
scatter2
# simple regression outcome: Attacks per year, predictor: defense budget
terror_lm <-  lm(n ~ DefenseBudget, data=war_cor)
summary(terror_lm)
scatter2 <- ggplot(war_cor, aes(x=DefenseBudget, y=n)) + geom_point(aes(color=iyear)) +  geom_smooth(method="lm") + xlab("Defense Budget") + ylab("Terrorist Attacks Per Year") + ggtitle("Relationship Between Defense Budget and Terrorist Attacks with Regression Line")
scatter2
library(pastecs)
# split into before and after
before <- terror_war %>% filter(iyear <= 2001)
after <- terror_war %>% filter(iyear > 2001)
# num attacks before and after 9/11
before_attacks <- before %>% group_by(iyear) %>% summarize(nrow(iyear))
# Let's look at the defense budget!
before %>% arrange(desc(nkill))
spending_before <- military_spending %>% filter(Year <=2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
spending_after <- military_spending %>% filter(Year > 2001) %>%  summarize(sum(DefenseBudget), mean(DefenseBudget))
# us terror attacks
us_terrorism <- terror_war %>% filter(country_txt=="United States")
us_terrorismb <- us_terrorism %>% filter(iyear <= 2001)
us_terrorisma <- us_terrorism %>% filter(iyear>2001)
# correlation tests!!
attack_yr <- terror_war %>% dplyr::count(iyear)
spending <- military_spending %>% filter(Year>=1970)
war_cor <- full_join(attack_yr, spending, by=c("iyear"="Year"))
cor1 <- cor.test(attack_yr$n, spending$DefenseBudget, method="spearman", conf.level = .99, exact = FALSE)
cor2 <- cor(attack_yr$n, spending$DefenseBudget, method="spearman")
r_sq <- cor2 ** 2
# find p-values
# p-value < .005 so not likely due to chance
install.packages(c("bookdown", "cli", "data.table", "digest", "htmltools", "rlang", "stringi", "xfun"))
install.packages(c("MASS", "Matrix", "mgcv", "nlme", "nnet", "rpart", "survival"), lib="C:/Program Files/R/R-4.1.3/library")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readxl)
library(dplyr)
library(plotly)
library(ggplot2)
library(readxl)
library(dplyr)
library(plotly)
library(lubridate)
library(treemap)
expenditures <-  read.csv("expenditures.txt", sep="\t")
setwd("C:/Users/Stewart/Documents/GitHub/dsc640")
expenditures <-  read.csv("expenditures.txt", sep="\t")
unemployment <-  read.csv("unemployement-rate-1948-2010.csv")
sums <- unemployment %>% group_by(Year) %>% summarise(Value = sum(Value))
ggplot(sums, aes(x=Year, y=Value)) + geom_area(fill="#009E73") + xlab("Year") + ylab("Unemployment Rate") +
ggtitle("Unemployment Rate 1948-2010")
exp_08 <- expenditures[expenditures$year == 2000,]
exp_08
exp_08 <- expenditures[expenditures$year == 2000,]
treemap(exp_08, index="category", vSize="expenditure", type="index")
exp_08 <- expenditures[expenditures$year == 2000,]
treemap(exp_08, index="category", vSize="expenditure", type="index", title="Expenditures by Category (2000)")
ggplot(expenditures, aes(x=year, y=expenditures, fill=category))
ggplot(expenditures, aes(x=year, y=expenditures, fill=category)) +geom_area()
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area()
expendiutres
head(expenditures) + tail(expenditures)
head(expenditures)
tail(expenditures)
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008")
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)")
exp_08 <- expenditures[expenditures$year == 2000,]
treemap(exp_08, index="category", vSize="expenditure", type="index", title="Expenditures by Category (2000)") +
scale_x_date()
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)")
+
scale_x_date()
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)") +
scale_x_continuous()
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)") +
scale_x_continuous(breaks = 10)
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)") +
scale_x_continuous(n.breaks=10)
ggplot(sums, aes(x=Year, y=Value)) + geom_area(fill="#009E73") + xlab("Year") + ylab("Unemployment Rate") +
ggtitle("Unemployment Rate 1948-2010")
ggplot(expenditures, aes(x=year, y=expenditure, fill=category)) +geom_area() + ggtitle("Expenditure by Category (1984-2008)") +
scale_x_continuous(n.breaks=10)
exp_08 <- expenditures[expenditures$year == 2000,]
treemap(exp_08, index="category", vSize="expenditure", type="index", title="Expenditures by Category (2000)")
treemap(exp_08, index="category", vSize="expenditure", type="index", title="Expenditures by Category (2000)")
